{% extends "base.html" %}
{% load static %}
{% block title %}–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø–æ—à—É–∫—É{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2 class="mb-4">–ó–Ω–∞–π–¥–µ–Ω—ñ –¥–æ—Å—Ç—É–ø–Ω—ñ –Ω–æ–º–µ—Ä–∏</h2>

  <!-- –§–∏–ª—å—Ç—Ä -->
  <div class="row g-2 mb-3 align-items-end">
    <div class="col-md-3">
      <label for="searchNumber" class="form-label">–ü–æ—à—É–∫ –∑–∞ –Ω–æ–º–µ—Ä–æ–º</label>
      <input type="text" class="form-control" id="searchNumber" placeholder="–ù–∞–ø—Ä. 7777">
    </div>

    <div class="col-md-2">
      <label for="priceFilter" class="form-label">–¶—ñ–Ω–∞</label>
      <select class="form-select" id="priceFilter">
          <option value="">–£—Å—ñ</option>
          <option value="2400">360</option>
          <option value="2400">2400</option>
          <option value="2400">4800</option>
          <option value="2400">12000</option>
          <option value="2400">18000</option>
          <option value="60000">60000</option>
          <option value="60000">96000</option>
      </select>
    </div>

    <div class="col-md-3">
      <label for="tscFilter" class="form-label">–¢–°–¶</label>
      <select class="form-select" id="tscFilter">
        <option value="">–£—Å—ñ</option>
      </select>
    </div>

    <div class="col-md-2">
      <label for="sortPrice" class="form-label">–°–æ—Ä—Ç—É–≤–∞—Ç–∏ –∑–∞ —Ü—ñ–Ω–æ—é</label>
      <select class="form-select" id="sortPrice">
        <option value="">–ë–µ–∑ —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è</option>
        <option value="asc">–ó—Ä–æ—Å—Ç–∞–Ω–Ω—è</option>
        <option value="desc">–°–ø–∞–¥–∞–Ω–Ω—è</option>
      </select>
    </div>

    <div class="col-md-2 d-flex gap-2">
      <button id="applyFiltersBtn" class="btn btn-outline-primary w-100">–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏</button>
      <button id="exportBtn" class="btn btn-outline-success w-100">Excel</button>
    </div>
  </div>

  <!-- –¢–∞–±–ª–∏—Ü–∞ -->
  <div class="table-responsive">
    <table class="table table-bordered table-striped align-middle text-center" id="resultsTable">
      <thead class="table-light">
        <tr>
          <th>–ù–æ–º–µ—Ä</th>
          <th>–¶—ñ–Ω–∞</th>
          <th>–ú—ñ—Å—Ü–µ –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script id="resultsData" type="application/json">{{ raw_results_json|safe }}</script>

  {% if digits %}
    <form method="post" action="{% url 'subscribe_search' %}" class="mt-4">
      {% csrf_token %}
      <input type="hidden" name="region" value="{{ region }}">
      <input type="hidden" name="tsc" value="{{ tsc }}">
      <input type="hidden" name="vehicle_type" value="{{ vehicle_type }}">
      <input type="hidden" name="digits" value="{{ digits }}">
      <button type="submit" class="btn btn-success">üîî –ü—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—è –Ω–∞ –ø–æ—à—É–∫</button>
    </form>
  {% endif %}


  <script src="{% static 'autonumbers/js/load_tscs.js' %}"></script>
  <script src="{% static 'autonumbers/js/results.js' %}"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <a href="{% url 'create_search' %}" class="btn btn-secondary mt-4">‚Üê –ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ –ø–æ—à—É–∫—É</a>
</div>
{% endblock %}